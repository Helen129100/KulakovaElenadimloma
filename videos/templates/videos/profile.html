{% extends 'base.html' %}
{% load staticfiles %}
{% load i18n %}

{% block title %}{{ page_user.username }}{% endblock %}

{% block content %}
<div class="container">
	<div class="gradient_block"></div>
	{% csrf_token %}
	<div class="mt-5 row">
		<div class="col-sm-10 offset-sm-1">
			{% if messages %}
			{% for message in messages %}
			<div {% if message.tags %} class="{{ message.tags }}" {% endif %}>
				{{ message }}
				<button type="button" class="close" data-dismiss="alert" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			{% endfor %}
			{% endif %}

			<div class="container_profile mb-4">
				<div class="container_profile">
					{% if page_user.avatar %}
					<a href="{% url 'profile' page_user.username %}">
						<img src="{{ page_user.avatar.url }}" alt="profile_pic" class="user-profile-pic rounded-circle">
					</a>
					{% else %}
					<a href="{% url 'profile' page_user.username %}">
						<img src="{% static 'img/user.png' %}" class="user-profile-pic rounded-circle"
							alt="profile_pic" />
					</a>
					{% endif %}
				</div>

				<div class="container_profile_content">
					<div class="mt-3">
						<a href="{% url 'profile' page_user.username %}" class="h5">
							{{ page_user.username }}
						</a>
					</div>

					{% if user.id == page_user.id %}
					<div class="mt-3">
						<a href="{% url 'accounts:edit_profile' %}" role="button"
							class="btn btn-modif_purple btn-outline-secondary btn-sm">
							{% trans "Редактировать профиль" %}
						</a>
						<button id="upload" type="button"
							class="btn btn-modif_purple btn-outline-secondary btn-sm ml-2">
							{% trans "Загрузить видео" %}
						</button>
						<a class=" nav-link" href="{% url 'accounts:logout' %}">Выйти из аккаунта</a>
					</div>
					{% endif %}
				</div>
			</div>
		</div>
	</div>

	<h2 class="mt-5 mb-3">{% trans "Мои Видео" %}</h2>

	{% if not all_videos %}
	{% if user.id == page_user.id %}
	<h4 class="mt-5 text-center">
		{% trans "Нет видео еще" %}
	</h4>
	{% endif %}
	{% endif %}

	<div class="row">
		{% for video in all_videos %}
		<div class="col-md-4 mb-3">
			<div class="card">
				<div class="card-body position-relative">
					<a href="{% url 'videos:video' video.id %}">
						<video id="vid" width="100%" height="200" controls>
							<source src="{{ video.video_file.url }}" type="video/mp4">
						</video>
					</a>
					<div class="dropdown  position-absolute" style="top: 10px; right: 10px;">
						<button class="btn btn_options btn-secondary dropdown-toggle" type="button"
							id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">

						</button>
						<div class="dropdown-menu " aria-labelledby="dropdownMenuButton">
							{% if user.id == page_user.id %}
							<form action="{% url 'videos:delete_video' video.id %}" method="post"
								style="display: inline;">
								{% csrf_token %}
								<button type="submit" class="dropdown-item"
									onclick="return confirm('Вы уверены, что хотите удалить это видео?');">
									{% trans "Удалить" %}
								</button>
							</form>
							<button id="edit" data-id="{{ video.id }}" type="button"
								class="dropdown-item">Редактировать</button>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		</div>
		{% if forloop.counter|divisibleby:3 %}
	</div>
	<div class="row">{% endif %}
		{% endfor %}
	</div>
</div>

{% endblock %}